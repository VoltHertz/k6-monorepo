# Checklist de Revis√£o de Qualidade - Casos de Uso

## üéØ Objetivo

Este checklist garante que **todos os casos de uso** estejam completos, consistentes e prontos para implementa√ß√£o antes de serem aprovados.

---

## üìã Checklist Completo

### ‚úÖ Se√ß√£o 1: Metadados e Identifica√ß√£o

- [ ] **ID do UC**: Segue padr√£o `UC00X` (3 d√≠gitos, zero-padded)
- [ ] **Nome do Arquivo**: `UC00X-kebab-case-name.md` (m√°x 50 chars)
- [ ] **Status Badge**: Presente no topo (`üöß Draft`, `üîÑ In Review`, `‚úÖ Approved`)
- [ ] **Prioridade**: Definida (P0, P1, P2, P3) e alinhada com matriz de prioriza√ß√£o
- [ ] **Complexidade**: Definida (1-5) e alinhada com roadmap
- [ ] **Sprint**: Especificado (Sprint X, Semana Y) conforme roadmap
- [ ] **Esfor√ßo**: Estimado em horas e validado com roadmap

**Refer√™ncias**:
- Matriz de Prioriza√ß√£o: `docs/casos_de_uso/fase2-matriz-priorizacao.md`
- Roadmap: `docs/casos_de_uso/fase2-roadmap-implementacao.md`

---

### ‚úÖ Se√ß√£o 2: Descri√ß√£o e Contexto

- [ ] **Perfil de Usu√°rio**: Claramente definido (Visitante, Comprador, Admin)
- [ ] **Distribui√ß√£o de Tr√°fego**: Especificada (% do total) conforme perfis Fase 1
- [ ] **Objetivo de Neg√≥cio**: Descrito de forma concisa e realista
- [ ] **Contexto**: Quando e por que o UC ocorre est√° claro
- [ ] **Valor de Neg√≥cio**: Justificativa de import√¢ncia est√° presente

**Refer√™ncias**:
- Perfis de Usu√°rio: `docs/casos_de_uso/fase1-perfis-de-usuario.md`

---

### ‚úÖ Se√ß√£o 3: Endpoints e API

- [ ] **Todos os Endpoints**: Listados com m√©todo HTTP (GET, POST, PUT, DELETE)
- [ ] **SLO Individual**: Cada endpoint tem threshold (P95 < Xms)
- [ ] **Observa√ß√µes**: Particularidades documentadas (ex: "FAKE: n√£o persiste")
- [ ] **Total de Endpoints**: Contabilizado (READ vs WRITE)
- [ ] **Headers Obrigat√≥rios**: Documentados (Content-Type, Authorization, etc.)
- [ ] **Query Params**: Especificados quando aplic√°vel (limit, skip, q, etc.)
- [ ] **Request Body**: Formato JSON documentado (para POST/PUT)

**Refer√™ncias**:
- Invent√°rio de Endpoints: `docs/casos_de_uso/fase1-inventario-endpoints.csv`

---

### ‚úÖ Se√ß√£o 4: SLOs (Service Level Objectives)

- [ ] **P95 Latency**: Threshold definido e justificado
- [ ] **P99 Latency**: Threshold definido (margem de seguran√ßa)
- [ ] **Error Rate**: Threshold definido (< X%)
- [ ] **Checks**: Threshold definido (> X%)
- [ ] **Rationale**: Cada SLO tem justificativa (refer√™ncia ao baseline)
- [ ] **Baseline**: Referenciado (`fase1-baseline-slos.md`)
- [ ] **M√©trica Completa**: Tags inclu√≠das (ex: `http_req_duration{feature:products}`)

**Refer√™ncias**:
- Baseline SLOs: `docs/casos_de_uso/fase1-baseline-slos.md`

---

### ‚úÖ Se√ß√£o 5: Dados de Teste

- [ ] **Arquivos Necess√°rios**: Listados com localiza√ß√£o (`data/test-data/`)
- [ ] **Volume**: Especificado (ex: 100 items, 50 IDs)
- [ ] **Fonte**: Origem dos dados documentada (`fulldummyjsondata/` ou gerado)
- [ ] **Estrat√©gia de Refresh**: Definida (semanal, mensal, on-demand)
- [ ] **Comando de Gera√ß√£o**: Inclu√≠do (se aplic√°vel)
- [ ] **Depend√™ncias de Dados**: Identificadas (ex: requer dados de UC003)

**Notas**:
- Dados devem estar em `data/test-data/` (N√ÉO em `fulldummyjsondata/`)
- SharedArray deve ser usado para carregar dados (memory-efficient)

---

### ‚úÖ Se√ß√£o 6: Fluxo Principal

- [ ] **Pr√©-condi√ß√µes**: Claramente definidas
- [ ] **Steps**: Numerados sequencialmente (1, 2, 3...)
- [ ] **Request Details**: HTTP method, endpoint, headers, body documentados
- [ ] **Valida√ß√µes**: Checks especificados com ‚úÖ
- [ ] **Checks Human-Readable**: `'status is 200'` (n√£o `'200'`)
- [ ] **Think Times**: Especificados (ex: `2-5s (navega√ß√£o casual)`)
- [ ] **P√≥s-condi√ß√µes**: Estado esperado ap√≥s fluxo documentado
- [ ] **M√°ximo 10 Steps**: Fluxo n√£o √© excessivamente longo

**Regras**:
- Think times baseados em perfis de usu√°rio (Fase 1)
- Valida√ß√µes devem ser test√°veis com k6 `check()`

---

### ‚úÖ Se√ß√£o 7: Fluxos Alternativos

- [ ] **Cen√°rios de Erro**: Identificados (ex: 401, 404, 500)
- [ ] **Edge Cases**: Documentados (ex: produto fora de estoque)
- [ ] **A√ß√µes de Recupera√ß√£o**: Especificadas (ex: retry, refresh token)
- [ ] **Valida√ß√µes de Erro**: Checks com ‚ùå para falhas esperadas

**Notas**:
- M√≠nimo 1 cen√°rio de erro documentado
- DummyJSON fake writes devem ter edge case documentado

---

### ‚úÖ Se√ß√£o 8: Implementa√ß√£o

- [ ] **Localiza√ß√£o do Teste**: Arquivo especificado (`tests/api/<feature>/<name>.test.ts`)
- [ ] **Configura√ß√£o de Cen√°rio**: Executor definido (`constant-arrival-rate` ou `ramping-arrival-rate`)
- [ ] **Tags Obrigat√≥rias**: `feature`, `kind`, `uc` especificadas
- [ ] **Thresholds**: Alinhados com SLOs (P95, error rate, checks)
- [ ] **VUs**: `preAllocatedVUs` e `maxVUs` definidos
- [ ] **Duration**: Definida (ou vari√°vel `__ENV.K6_DURATION`)
- [ ] **Rate/RPS**: Definida (ou vari√°vel `__ENV.K6_RPS`)

**Regras**:
- **SEMPRE** usar open model executors (constant-arrival-rate)
- **NUNCA** usar closed model (shared-iterations, per-vu-iterations)

---

### ‚úÖ Se√ß√£o 9: Comandos de Teste

- [ ] **Smoke Test**: Comando documentado (30-60s, 1-2 RPS)
- [ ] **Baseline Test**: Comando documentado (5min, 5-10 RPS)
- [ ] **Stress Test**: Comando documentado (10min+, 20+ RPS)
- [ ] **Vari√°veis de Ambiente**: `K6_RPS`, `K6_DURATION` utilizadas
- [ ] **CI/CD**: Workflows referenciados (`.github/workflows/`)

**Exemplo M√≠nimo**:
```bash
K6_RPS=1 K6_DURATION=30s k6 run tests/api/example/test.test.ts
```

---

### ‚úÖ Se√ß√£o 10: M√©tricas Customizadas

- [ ] **Trends**: Definidas (se aplic√°vel) com nomenclatura correta (`feature_action_duration_ms`)
- [ ] **Counters**: Definidos (se aplic√°vel) com nomenclatura correta (`feature_action_errors`)
- [ ] **Imports**: `import { Trend, Counter } from 'k6/metrics'` presente
- [ ] **Uso no VU Code**: `.add()` chamado corretamente
- [ ] **Dashboards**: Links inclu√≠dos (se dispon√≠vel)

**Regras**:
- Snake_case: `product_list_duration_ms` (n√£o camelCase)
- Trends para lat√™ncia, Counters para eventos de neg√≥cio

---

### ‚úÖ Se√ß√£o 11: Observa√ß√µes Importantes

- [ ] **Limita√ß√µes da API**: Documentadas (ex: "DummyJSON fake writes")
- [ ] **Particularidades do Teste**: Identificadas (ex: pagina√ß√£o usa limit/skip)
- [ ] **Considera√ß√µes de Desempenho**: Inclu√≠das (ex: usar SharedArray)
- [ ] **Warnings**: Avisos relevantes destacados com ‚ö†Ô∏è

**Obrigat√≥rio**:
- Se UC usa POST/PUT/DELETE do DummyJSON, DEVE ter aviso "FAKE: n√£o persiste dados"

---

### ‚úÖ Se√ß√£o 12: Depend√™ncias

- [ ] **UCs Bloqueadores**: Listados (ex: "UC003 (Auth) - requer token")
- [ ] **UCs Dependentes**: Identificados (quem usa este UC)
- [ ] **Libs Necess√°rias**: Especificadas (ex: `libs/http/auth.ts`)
- [ ] **Dados Requeridos**: Listados (ex: `users-credentials.csv` de UC003)
- [ ] **Valida√ß√£o de Depend√™ncias**: Confirmadas com mapa de depend√™ncias

**Refer√™ncias**:
- Mapa de Depend√™ncias: `docs/casos_de_uso/fase2-mapa-dependencias.md`

---

### ‚úÖ Se√ß√£o 13: Libs/Helpers Criados

- [ ] **Localiza√ß√£o**: Path completo especificado (`libs/<categoria>/<nome>.ts`)
- [ ] **Fun√ß√µes Exportadas**: Assinatura TypeScript documentada
- [ ] **Exemplo de Uso**: Code snippet inclu√≠do
- [ ] **Testes Unit√°rios**: Referenciados (se aplic√°vel)
- [ ] **Depend√™ncias da Lib**: Identificadas (imports)

**Nota**:
- Se√ß√£o opcional, OBRIGAT√ìRIA se UC criar nova lib
- Exemplos: `libs/http/auth.ts` (UC003), `libs/scenarios/journey-builder.ts` (UC009)

---

### ‚úÖ Se√ß√£o 14: Hist√≥rico e Checklist Interno

- [ ] **Hist√≥rico de Mudan√ßas**: Tabela presente com data, autor, mudan√ßa
- [ ] **Checklist de Completude**: Inclu√≠do no final do UC
- [ ] **Refer√™ncias**: Links para docs relevantes (DummyJSON, k6, fase1/2)

---

## üîç Revis√£o por Tipo de UC

### UCs Tier 0 (Independentes)

**Foco adicional**:
- [ ] N√£o tem depend√™ncias de auth
- [ ] Dados de teste autocontidos
- [ ] Endpoints READ apenas (GET)
- [ ] SLOs conservadores (primeiro baseline)

**Exemplos**: UC001, UC002, UC004, UC007

---

### UCs Tier 1 (Dependentes de Auth)

**Foco adicional**:
- [ ] Depend√™ncia de UC003 est√° documentada
- [ ] `libs/http/auth.ts` est√° referenciada
- [ ] Headers de autentica√ß√£o especificados (`Authorization: Bearer ${token}`)
- [ ] Cen√°rio de erro: token inv√°lido/expirado documentado

**Exemplos**: UC005, UC006, UC008, UC012, UC013

---

### UCs Tier 2 (Jornadas Compostas)

**Foco adicional**:
- [ ] M√∫ltiplos UCs dependentes listados
- [ ] `libs/scenarios/journey-builder.ts` referenciada (se aplic√°vel)
- [ ] Think times entre steps especificados
- [ ] M√©tricas de jornada customizadas (`journey_duration_total_ms`)
- [ ] Session management documentado

**Exemplos**: UC009, UC010, UC011

---

## üìä Matriz de Valida√ß√£o R√°pida

| Crit√©rio | Essencial | Importante | Desej√°vel |
|----------|-----------|------------|-----------|
| ID e Nome corretos | ‚úÖ | | |
| Perfil de usu√°rio claro | ‚úÖ | | |
| Endpoints documentados | ‚úÖ | | |
| SLOs definidos com rationale | ‚úÖ | | |
| Fluxo principal detalhado | ‚úÖ | | |
| Valida√ß√µes especificadas | ‚úÖ | | |
| Think times especificados | | ‚úÖ | |
| Dados de teste identificados | ‚úÖ | | |
| Cen√°rios de erro documentados | | ‚úÖ | |
| Depend√™ncias mapeadas | ‚úÖ | | |
| Limita√ß√µes documentadas | ‚úÖ | | |
| Comandos de teste corretos | | ‚úÖ | |
| M√©tricas customizadas | | | ‚úÖ |
| Libs/helpers documentados | ‚úÖ (se criar) | | |
| Hist√≥rico de mudan√ßas | | | ‚úÖ |

**Legenda**:
- **Essencial**: Bloqueia aprova√ß√£o se ausente
- **Importante**: Deve ter, mas pode ser adicionado em review
- **Desej√°vel**: Nice-to-have, n√£o bloqueia

---

## üö¶ Crit√©rios de Aprova√ß√£o

### üöß Draft ‚Üí üîÑ In Review

**Requisitos**:
- [ ] Todas as se√ß√µes essenciais preenchidas
- [ ] Fluxo principal completo
- [ ] SLOs definidos
- [ ] Depend√™ncias identificadas

**A√ß√£o**: Autor marca como `üîÑ In Review` e solicita revis√£o

---

### üîÑ In Review ‚Üí ‚úÖ Approved

**Requisitos**:
- [ ] Revisor validou checklist completo
- [ ] Todos os itens "Essenciais" OK
- [ ] Pelo menos 80% dos "Importantes" OK
- [ ] Ader√™ncia ao guia de estilo validada
- [ ] Alinhamento com roadmap/matriz confirmado

**A√ß√£o**: Revisor marca como `‚úÖ Approved` e comita

---

### ‚úÖ Approved ‚Üí Implementa√ß√£o

**Requisitos**:
- [ ] UC aprovado h√° pelo menos 24h (cool-off period)
- [ ] Dados de teste gerados/dispon√≠veis
- [ ] Libs dependentes implementadas (se aplic√°vel)
- [ ] UCs bloqueadores completos

**A√ß√£o**: Dev inicia implementa√ß√£o do teste k6

---

## üìù Template de Coment√°rio de Review

```markdown
## Review UC00X - [Nome]

### ‚úÖ Aprovado com ressalvas

**Pontos Fortes**:
- [Item bem feito 1]
- [Item bem feito 2]

**Melhorias Necess√°rias**:
- [ ] [Item a corrigir 1] - Criticidade: Alta/M√©dia/Baixa
- [ ] [Item a corrigir 2] - Criticidade: Alta/M√©dia/Baixa

**Sugest√µes (Opcional)**:
- [Melhoria nice-to-have 1]

**Decis√£o**: Aprovar ap√≥s corre√ß√µes de criticidade Alta
**Pr√≥ximo Passo**: Autor corrige e marca como ‚úÖ Approved
```

---

## üß™ Teste de Valida√ß√£o (Smoke Review)

Antes de aprovar, executar **smoke review** (5 minutos):

1. ‚úÖ Abrir arquivo `UC00X-nome.md`
2. ‚úÖ Verificar badge de status no topo
3. ‚úÖ Ler se√ß√£o "Descri√ß√£o" - est√° claro?
4. ‚úÖ Conferir tabela de endpoints - todos documentados?
5. ‚úÖ Validar SLOs - tem rationale?
6. ‚úÖ Ler fluxo principal - steps claros?
7. ‚úÖ Verificar depend√™ncias - est√£o corretas?
8. ‚úÖ Conferir comandos de teste - funcionam?

**Se TODOS ‚úÖ**: Aprovar  
**Se 1+ ‚ùå**: Solicitar corre√ß√µes

---

## üìö Refer√™ncias

- **Template de UC**: `docs/casos_de_uso/templates/use-case-template.md`
- **Guia de Estilo**: `docs/casos_de_uso/templates/guia-de-estilo.md`
- **Fase 1 - Baseline SLOs**: `docs/casos_de_uso/fase1-baseline-slos.md`
- **Fase 2 - Matriz de Prioriza√ß√£o**: `docs/casos_de_uso/fase2-matriz-priorizacao.md`
- **Fase 2 - Roadmap**: `docs/casos_de_uso/fase2-roadmap-implementacao.md`
- **Fase 2 - Mapa de Depend√™ncias**: `docs/casos_de_uso/fase2-mapa-dependencias.md`

---

## üîÑ Versionamento do Checklist

| Vers√£o | Data | Mudan√ßas |
|--------|------|----------|
| 1.0 | 2025-10-03 | Cria√ß√£o inicial do checklist de qualidade |

---

## ‚úÖ Meta-Checklist (Valida√ß√£o do Pr√≥prio Checklist)

Este checklist est√° completo?

- [x] Cobre todas as se√ß√µes do template de UC
- [x] Crit√©rios de aprova√ß√£o est√£o claros
- [x] Matriz de valida√ß√£o r√°pida inclu√≠da
- [x] Template de coment√°rio de review fornecido
- [x] Refer√™ncias a docs de fase 1/2 inclu√≠das
- [x] Diferencia√ß√£o entre Tier 0/1/2 documentada
- [x] Smoke review (5 min) descrito
- [x] Versionamento do checklist inclu√≠do
