# Guia de Estilo - Escrita de Casos de Uso

## üéØ Objetivo

Este guia estabelece **conven√ß√µes de escrita, nomenclatura e estrutura** para garantir documenta√ß√£o consistente, clara e manuten√≠vel dos casos de uso k6.

---

## üìù Conven√ß√µes de Nomenclatura

### IDs de Casos de Uso

**Padr√£o**: `UC00X` (3 d√≠gitos, zero-padded)

**Exemplos**:
- ‚úÖ `UC001` - Browse Products Catalog
- ‚úÖ `UC013` - Content Moderation
- ‚ùå `UC1` - Falta zero-padding
- ‚ùå `UC-001` - N√£o usar h√≠fen

**Regras**:
- IDs s√£o sequenciais e imut√°veis (n√£o renumerar ap√≥s cria√ß√£o)
- UC001-UC099: Casos de uso principais
- UC100+: Extens√µes futuras (se necess√°rio)

---

### Nomes de Arquivo

**Padr√£o**: `UC00X-kebab-case-name.md`

**Exemplos**:
- ‚úÖ `UC001-browse-products-catalog.md`
- ‚úÖ `UC003-user-login-profile.md`
- ‚úÖ `UC009-user-journey-unauthenticated.md`
- ‚ùå `UC001-Browse Products Catalog.md` (sem espa√ßos)
- ‚ùå `UC001_browse_products.md` (usar h√≠fen, n√£o underscore)
- ‚ùå `browse-products.md` (falta ID do UC)

**Regras**:
- Sempre come√ßar com `UC00X-`
- Usar kebab-case (h√≠fens entre palavras)
- M√°ximo 50 caracteres no nome total
- Extens√£o `.md` (Markdown)

---

### Nomes de Testes k6

**Padr√£o**: `<action>-<resource>.test.ts`

**Exemplos**:
- ‚úÖ `browse-catalog.test.ts` (UC001)
- ‚úÖ `search-products.test.ts` (UC002)
- ‚úÖ `user-login-profile.test.ts` (UC003)
- ‚úÖ `cart-operations-read.test.ts` (UC005)
- ‚ùå `test1.test.ts` (sem contexto)
- ‚ùå `browseCatalog.test.ts` (n√£o usar camelCase)

**Regras**:
- A√ß√£o primeiro, depois recurso
- M√°ximo 40 caracteres
- Extens√£o `.test.ts` (TypeScript test)

---

### Tags k6

**Tags Obrigat√≥rias**:

```javascript
tags: { 
  feature: 'products',  // Domain area
  kind: 'browse',       // Operation type
  uc: 'UC001'           // Use case ID
}
```

**Valores Permitidos**:

| Tag | Valores | Descri√ß√£o |
|-----|---------|-----------|
| `feature` | `products`, `auth`, `users`, `carts`, `posts`, `comments` | Dom√≠nio funcional |
| `kind` | `browse`, `search`, `login`, `checkout`, `admin`, `moderate` | Tipo de opera√ß√£o |
| `uc` | `UC001` - `UC013` | ID do caso de uso |

**Regras**:
- Sempre usar lowercase (sem mai√∫sculas)
- feature = dom√≠nio da API (alinhado com endpoints)
- kind = verbo/a√ß√£o do usu√°rio
- uc = ID exato do UC (com zero-padding)

---

### M√©tricas Customizadas

**Padr√£o**: `<feature>_<action>_<unit>`

**Exemplos**:
- ‚úÖ `product_list_duration_ms` (Trend)
- ‚úÖ `product_list_errors` (Counter)
- ‚úÖ `auth_login_success` (Counter)
- ‚úÖ `cart_add_item_duration_ms` (Trend)
- ‚ùå `duration` (muito gen√©rico)
- ‚ùå `productListDuration` (n√£o usar camelCase)

**Regras**:
- Snake_case (underscores)
- Trends: sufixo `_duration_ms`, `_latency_ms`, `_time_ms`
- Counters: sufixo `_errors`, `_success`, `_count`
- Prefixo com feature (ex: `product_`, `auth_`, `cart_`)

---

## ‚úçÔ∏è Conven√ß√µes de Escrita

### Tom e Voz

- **Imperativo**: "Execute o request", "Valide a resposta" (n√£o "Executar", "Validar")
- **T√©cnico**: Termos precisos (n√£o amb√≠guos)
- **Conciso**: Evitar prolixidade, ir direto ao ponto
- **Objetivo**: Baseado em fatos, n√£o opini√µes

**Exemplo Bom ‚úÖ**:
> Execute `GET /products?limit=20` e valide que `status === 200` e `products.length <= 20`.

**Exemplo Ruim ‚ùå**:
> O usu√°rio pode executar uma requisi√ß√£o GET no endpoint de produtos com limite de 20 itens e depois verificar se a resposta est√° ok.

---

### Descri√ß√µes de Checks

**Padr√£o**: Senten√ßas human-readable, afirmativas

**Exemplos**:
- ‚úÖ `'status is 200'`
- ‚úÖ `'has products array'`
- ‚úÖ `'response time < 300ms'`
- ‚úÖ `'user is authenticated'`
- ‚ùå `'200'` (muito curto)
- ‚ùå `'check_status'` (n√£o descritivo)
- ‚ùå `'Status code should be 200 if request succeeds'` (muito verboso)

**Regras**:
- Come√ßar com verbo no presente (is, has, contains)
- M√°ximo 50 caracteres
- Sem pontua√ß√£o final
- Usar aspas simples em JavaScript

---

### Formata√ß√£o de C√≥digo

**Headers HTTP**:
```http
GET /products?limit=20&skip=0
Headers:
  Content-Type: application/json
  Authorization: Bearer ${token}
```

**Request Bodies**:
```json
{
  "username": "emilys",
  "password": "emilyspass",
  "expiresInMins": 60
}
```

**k6 Code Blocks**:
```javascript
const res = http.get(`${BASE_URL}/products`, {
  headers: baseHeaders(),
  tags: { feature: 'products', kind: 'browse', uc: 'UC001' }
});
```

**Regras**:
- Usar syntax highlighting (http, json, javascript, typescript, bash)
- Indentar 2 espa√ßos (n√£o tabs)
- Vari√°veis de ambiente: `${VAR_NAME}` ou `__ENV.VAR_NAME`

---

### Think Times

**Nota√ß√£o**: `Think Time: X-Ys (contexto)`

**Exemplos**:
- ‚úÖ `Think Time: 2-5s (navega√ß√£o casual)`
- ‚úÖ `Think Time: 3-7s (decis√£o de compra)`
- ‚úÖ `Think Time: 5-10s (an√°lise de dados admin)`
- ‚úÖ `Think Time: 1s (automa√ß√£o r√°pida)`
- ‚ùå `Wait 3 seconds` (n√£o especifica range)
- ‚ùå `Think Time: 3000ms` (usar segundos, n√£o ms)

**Regras**:
- Sempre usar range (min-max) exceto para valores fixos
- Unidade: segundos (s)
- Incluir contexto entre par√™nteses
- Baseado em perfis de usu√°rio (Fase 1)

---

### Documenta√ß√£o de SLOs

**Formato de Tabela**:

| M√©trica | Threshold | Rationale |
|---------|-----------|-----------|
| `http_req_duration{feature:products}` (P95) | < 300ms | Baseline Fase 1: P95 real = 250ms, margem 20% |
| `http_req_failed{feature:products}` | < 0.5% | Opera√ß√£o cr√≠tica, toler√¢ncia m√≠nima |
| `checks{uc:UC001}` | > 99.5% | Valida√ß√µes devem passar, permite 0.5% falhas tempor√°rias |

**Regras**:
- Sempre incluir rationale (justificativa)
- Referenciar baseline: `docs/casos_de_uso/fase1-baseline-slos.md`
- Percentis: P95, P99 (n√£o P50 para thresholds)
- Error rate: < X% (n√£o > X%)
- Checks: > X% (n√£o < X%)

---

## üìê Estrutura de Fluxos

### Numera√ß√£o de Steps

**Padr√£o Simples** (fluxo linear):
```markdown
**Step 1: Login**
[Request, valida√ß√µes, think time]

**Step 2: Browse Products**
[Request, valida√ß√µes, think time]

**Step 3: View Details**
[Request, valida√ß√µes, think time]
```

**Padr√£o Complexo** (subpassos):
```markdown
**Step 1: Autentica√ß√£o**

1.1. POST /auth/login
     - Valida√ß√£o: status 200
     - Valida√ß√£o: token presente

1.2. GET /auth/me (verificar sess√£o)
     - Valida√ß√£o: status 200
     - Valida√ß√£o: user.id > 0

**Step 2: Navega√ß√£o**
[...]
```

**Regras**:
- Steps principais: numera√ß√£o sequencial (1, 2, 3...)
- Subpassos: nota√ß√£o decimal (1.1, 1.2, 2.1...)
- M√°ximo 10 steps principais por UC
- M√°ximo 5 subpassos por step principal

---

### Documenta√ß√£o de Valida√ß√µes

**Padr√£o Inline** (durante step):
```markdown
**Valida√ß√µes**:
- ‚úÖ Status code = 200
- ‚úÖ Response contains `products` array
- ‚úÖ `products.length` <= 20
- ‚úÖ Each product has `id`, `title`, `price`
```

**Padr√£o Code Block** (k6 code):
```javascript
check(res, {
  'status is 200': (r) => r.status === 200,
  'has products array': (r) => Array.isArray(r.json('products')),
  'products count valid': (r) => r.json('products').length <= 20,
}, { uc: 'UC001', step: 'list' });
```

**Regras**:
- Usar ‚úÖ para valida√ß√µes esperadas
- Usar ‚ùå para valida√ß√µes de erro (fluxos alternativos)
- Sempre incluir tags de check: `{ uc: 'UC00X', step: 'nome' }`

---

## üé® Conven√ß√µes Visuais

### Emojis (Uso Consistente)

| Emoji | Uso | Exemplo |
|-------|-----|---------|
| üìã | Descri√ß√£o, overview | `## üìã Descri√ß√£o` |
| üîó | Endpoints, links | `## üîó Endpoints Envolvidos` |
| üìä | SLOs, m√©tricas | `## üìä SLOs` |
| üì¶ | Dados, massa de teste | `## üì¶ Dados de Teste` |
| üîÑ | Fluxo principal | `## üîÑ Fluxo Principal` |
| üîÄ | Fluxos alternativos | `## üîÄ Fluxos Alternativos` |
| ‚öôÔ∏è | Implementa√ß√£o, config | `## ‚öôÔ∏è Implementa√ß√£o` |
| üß™ | Testes, comandos | `## üß™ Comandos de Teste` |
| üìà | M√©tricas customizadas | `## üìà M√©tricas Customizadas` |
| ‚ö†Ô∏è | Avisos, limita√ß√µes | `## ‚ö†Ô∏è Observa√ß√µes Importantes` |
| üîí | Depend√™ncias | `## üîó Depend√™ncias` |
| üìÇ | Libs, helpers | `## üìÇ Libs/Helpers Criados` |
| ‚úÖ | Checklist, completo | `- ‚úÖ Item completo` |
| üöß | Draft, em progresso | `**Status**: üöß Draft` |

**Regras**:
- Um emoji por se√ß√£o de cabe√ßalho
- N√£o usar emojis no corpo do texto (exceto listas de status)
- Consist√™ncia entre todos os UCs

---

### Status Badges

**Padr√£o**:
```markdown
> **Status**: üöß Draft | ‚úÖ Approved | üîÑ In Review  
> **Prioridade**: P0 (Cr√≠tico)  
> **Complexidade**: 1 (Muito Simples)  
> **Sprint**: Sprint 1 (Semana 4)  
> **Esfor√ßo Estimado**: 4h  
```

**Valores Permitidos**:

- **Status**: `üöß Draft`, `üîÑ In Review`, `‚úÖ Approved`
- **Prioridade**: `P0 (Cr√≠tico)`, `P1 (Importante)`, `P2 (Secund√°rio)`, `P3 (Nice-to-have)`
- **Complexidade**: `1 (Muito Simples)` a `5 (Muito Complexa)`
- **Sprint**: `Sprint X (Semana Y)` (conforme roadmap)
- **Esfor√ßo**: `Xh` (horas estimadas)

---

### Tabelas

**Alinhamento**:
- Coluna 1 (nome): esquerda
- Colunas num√©ricas: direita
- Demais colunas: esquerda

**Exemplo**:
```markdown
| Endpoint | M√©todo | P95 | Observa√ß√µes |
|----------|--------|----:|-------------|
| /products | GET | 250ms | Pagina√ß√£o padr√£o |
| /auth/login | POST | 380ms | Gera√ß√£o de JWT |
```

**Regras**:
- Sempre usar cabe√ßalho com `|---|---|---|`
- Padding interno: 1 espa√ßo antes/depois de `|`
- M√°ximo 6 colunas por tabela

---

## üî§ Gloss√°rio de Termos

### Termos T√©cnicos (Usar Consistentemente)

| Termo Correto ‚úÖ | Evitar ‚ùå | Contexto |
|------------------|-----------|----------|
| Threshold | Limite, Boundary | SLOs k6 |
| Check | Valida√ß√£o, Assert | Valida√ß√µes k6 |
| Think time | Wait time, Delay | Tempo entre steps |
| VU (Virtual User) | User, Usu√°rio | Executores k6 |
| Executor | Scenario type | Open/closed model |
| SharedArray | Array, Lista | Dados de teste |
| Trend | Metric, Latency | M√©trica de lat√™ncia |
| Counter | Metric, Count | M√©trica de contagem |
| Rate | Taxa, Porcentagem | RPS ou error rate |
| P95, P99 | 95th percentile | Percentis de lat√™ncia |
| Baseline | Base, Reference | SLOs de refer√™ncia |
| Smoke test | Quick test | Teste r√°pido (30-60s) |
| Stress test | Load test | Teste de carga alta |
| Soak test | Endurance test | Teste de longa dura√ß√£o |

---

### Abrevia√ß√µes Permitidas

| Abrevia√ß√£o | Significado | Uso |
|------------|-------------|-----|
| UC | Use Case | IDs de casos de uso |
| SLO | Service Level Objective | Metas de desempenho |
| RPS | Requests Per Second | Taxa de requisi√ß√µes |
| VU | Virtual User | Usu√°rios virtuais k6 |
| CI/CD | Continuous Integration/Deployment | Pipelines |
| API | Application Programming Interface | Endpoints |
| JWT | JSON Web Token | Autentica√ß√£o |
| P95, P99 | 95th/99th Percentile | Percentis de lat√™ncia |

**Regras**:
- Expandir na primeira men√ß√£o: "SLO (Service Level Objective)"
- Depois usar s√≥ abrevia√ß√£o
- N√£o criar novas abrevia√ß√µes (usar gloss√°rio)

---

## üìö Refer√™ncias Externas

### Links para Documenta√ß√£o

**Padr√£o**: `[Texto Descritivo](URL)`

**Exemplos**:
- ‚úÖ `[DummyJSON Products API](https://dummyjson.com/docs/products)`
- ‚úÖ `[k6 Executors](https://grafana.com/docs/k6/latest/using-k6/scenarios/executors/)`
- ‚ùå `https://dummyjson.com/docs/products` (sem texto descritivo)
- ‚ùå `Click here` (texto gen√©rico)

**Regras**:
- Sempre incluir texto descritivo
- URLs completas (n√£o encurtar)
- Verificar links antes de commit

---

### Refer√™ncias Internas

**Padr√£o Relativo**: `../path/to/file.md`

**Exemplos**:
- ‚úÖ `docs/casos_de_uso/fase1-baseline-slos.md`
- ‚úÖ `../fase2-roadmap-implementacao.md` (se no mesmo diret√≥rio)
- ‚ùå `/home/Volt/k6-monorepo/docs/...` (caminho absoluto local)

**Regras**:
- Usar caminhos relativos sempre que poss√≠vel
- Referenciar arquivos .md, .csv, .json relevantes
- Incluir √¢ncoras para se√ß√µes: `file.md#section`

---

## ‚úÖ Checklist de Estilo

Antes de marcar UC como ‚úÖ Approved, verificar:

### Nomenclatura
- [ ] ID do UC segue padr√£o `UC00X` (3 d√≠gitos)
- [ ] Arquivo nomeado: `UC00X-kebab-case-name.md`
- [ ] Tags k6: `feature`, `kind`, `uc` corretamente especificadas
- [ ] M√©tricas customizadas: `feature_action_unit` (snake_case)

### Escrita
- [ ] Tom imperativo e t√©cnico
- [ ] Checks human-readable: `'status is 200'`
- [ ] Think times especificados: `2-5s (contexto)`
- [ ] SLOs com rationale (justificativa)

### Estrutura
- [ ] Steps numerados sequencialmente (1, 2, 3...)
- [ ] Valida√ß√µes com ‚úÖ ou ‚ùå
- [ ] Emojis consistentes nos cabe√ßalhos
- [ ] Status badge completo no topo

### Formata√ß√£o
- [ ] Code blocks com syntax highlighting
- [ ] Tabelas com alinhamento correto
- [ ] Links com texto descritivo
- [ ] M√°ximo 80 caracteres por linha (quando poss√≠vel)

### Refer√™ncias
- [ ] Links externos v√°lidos (testados)
- [ ] Refer√™ncias internas com caminhos relativos
- [ ] Gloss√°rio usado consistentemente

---

## üöÄ Exemplos Pr√°ticos

### Bom Exemplo ‚úÖ

```markdown
# UC001 - Browse Products Catalog

> **Status**: ‚úÖ Approved  
> **Prioridade**: P0 (Cr√≠tico)  
> **Complexidade**: 1 (Muito Simples)  

## üìã Descri√ß√£o

### Perfil de Usu√°rio
- **Tipo**: Visitante An√¥nimo
- **Distribui√ß√£o de Tr√°fego**: 60% do total
- **Objetivo**: Explorar cat√°logo de produtos

## üîÑ Fluxo Principal

**Step 1: Listar Produtos**
```http
GET /products?limit=20&skip=0
```

**Valida√ß√µes**:
- ‚úÖ Status code = 200
- ‚úÖ Response contains `products` array

**Think Time**: 2-5s (navega√ß√£o casual)

## üìä SLOs

| M√©trica | Threshold | Rationale |
|---------|-----------|-----------|
| `http_req_duration{feature:products}` (P95) | < 300ms | Baseline: 250ms + 20% margem |
```

---

### Mau Exemplo ‚ùå

```markdown
# Browse Products (sem ID)

Status: draft (sem emoji/badge)

## Description (ingl√™s misturado)

User goes to website and looks at products. (tom casual)

## Flow (sem emoji)

1. GET /products (sem valida√ß√µes, sem think time)
   - Check status (sem especificar valor)
   
## SLOs (sem rationale)

P95 < 300ms (sem m√©trica completa, sem justificativa)
```

---

## üìù Versionamento do Guia

| Vers√£o | Data | Mudan√ßas |
|--------|------|----------|
| 1.0 | 2025-10-03 | Cria√ß√£o inicial do guia de estilo |

---

## üîó Refer√™ncias

- Template de UC: `docs/casos_de_uso/templates/use-case-template.md`
- Checklist de Qualidade: `docs/casos_de_uso/templates/checklist-qualidade.md`
- PRD: `docs/planejamento/PRD.md`
- Copilot Instructions: `.github/copilot-instructions.md`
